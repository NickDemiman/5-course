# Оптимизация схем БД

## Нормализация отношений

Фундаментальная зависимость - один ко многим

Пусть $R$ - универсальная схема отношений

$R = (A_1...A_n)$

$X \subseteq R$, $y \subseteq R$ - подмножество этой схемы отношений

$x \mapsto y$ - x функционально определяет y, если в любом экземпляре r со схемой R не существует двух кортежей совпадающих по x и не совпадающих по y

Если существует схема отношений r, такая, что в ней имеются по крайней мере два кортежа совпадают по x, но не совпадают по y $(x \cancel\mapsto y)$ - нет функц. зависимости

### Пример

R = (имя, адрес, товар, цена) = $(A_1, A_2, A_3, A_4)$

$\left.\begin{array}{ccc}A_1 \mapsto A_2\\A_2A_3 \mapsto A_4\\\end{array}\right\}F$

$r =$

| $A_1$  |  $A_2$   |  $A_3$   | $A_4$ |
|:------:|:--------:|:--------:|:-----:|
| ОАО'x' | M,ул.'y' | Карамель |  100  |
| ОАО'x' | M,ул.'y' |  Сахар   |  40   |
| ОАО'x' | M,ул.'y' | Пастила  |  140  |

Если в $\forall$ отношении нет совпадения по x, то будет иметь место $x \mapsto y$

$\underbrace{(A_1,A_3)}_{\text {нет совпадений}} \mapsto A_4$

$\left.\begin{array}{ccc}A_1 \mapsto A_2\\A_1A_3 \mapsto A_4\\\end{array}\right\}F$

  

Если x - книг $\Rightarrow$ [[Термины#ФЗ | ФЗ]]

R - универсальная схема отношений

F - множество функциональных зависимостей на этой схеме

Замыкание F называется множеством функциональных зависимостей, которые логически следуют из F $(F^+)$

[[Термины#ФЗ | ФЗ]] логически следует из F, если её можно получить с помощью Аксиом Армстронга.

  

### Аксиомы Арстронга

1. Рефлексивность

Если $x \subseteq y \subseteq R$, $y \mapsto x$ ^5a8e37

  

2. Пополнение

$x \mapsto y$, $z \subseteq R$

$x \cup z \mapsto y\cup z$

$(xz \mapsto yz)$, z может быть $\emptyset$

  

3. Транзитивность

Если $x \mapsto y$, $y \mapsto z$, то $x \mapsto z$

Исходные [[Термины#ФЗ | ФЗ]] выводится из Аксиом Армстронга, если в аксиоме 2: $z = \emptyset$

  

### Пример построения [[Термины#ЗМФЗ | ЗМФЗ]]

#### Условия

Пусть задана схема отношений:

$R = (A,B,C)$

$F = (A \mapsto B, B \mapsto C)$

$F^+ - ?$

#### Решение

1. $A \mapsto A$, $B \mapsto B$, $C \mapsto C$

$AB \mapsto A$, $AB \mapsto B$

$AC \mapsto A$, $AB \mapsto C$

$BC \mapsto C$, $BC \mapsto B$

$ABC \mapsto A$, $ABC \mapsto B$ $ABC \mapsto C$

$ABC \mapsto AB$, $ABC \mapsto AC$ $ABC \mapsto BC$

$ABC \mapsto ABC$

$AB \mapsto AB$, $AC \mapsto AC$, $BC \mapsto BC$

[[Термины#ФЗ | ФЗ]], полученное по аксиоме [[#^5a8e37 | Рефлексивности]] называется тривиальными

  

2. $A \mapsto AB$ (`ФЗ 1` пополняют атрибутами А)

$AC \mapsto BC$ (`ФЗ 1` пополняют атрибутами C)

$B \mapsto BC$ (`ФЗ 2` пополняют атрибутами B)

$AB \mapsto AC$ (`ФЗ 2` пополняют атрибутами A)

$AC \mapsto ABC$ (`ФЗ 1` пополняют атрибутами AC)

$AB \mapsto ABC$ (`ФЗ 2` пополняют атрибутами AB)

  

3. $A \mapsto C$ - так как появилось новая [[Термины#ФЗ | ФЗ]], возвращаемся к шагу 2

  

2. $AB \mapsto BC$ (пополняем B)

$A \mapsto AC$ (пополняем А)

  

3. $A \mapsto ABC$; $A \mapsto AB$; $AB \mapsto ABC$

Все полученные [[Термины#ФЗ | ФЗ]] $\in F^+$

  

### Лемма

Имеют место следующие правила:

1. Объединение

$x \mapsto y$ (1)

$x \mapsto z$ (2)

Следовательно имеет место: $x \mapsto yz$ (3)

  

2. Декомпозиция

$x \mapsto y$ (1)

$z \subseteq y$ (2)

Следовательно имеет место: $x \mapsto z$ (3)

  

3. Псевдотранзитивность

Если $x \mapsto y$ (1)

$w \mapsto z$ (2)

Следовательно имеет место: $wx \mapsto z$ (3)